{"version":3,"sources":["utils/webRTCHandler.js","IntroductionPage/ConnectingButton.js","IntroductionPage/ConnectingButtons.js","store/actions.js","IntroductionPage/IntroductionPage.js","resources/images/Mu.png","JoinRoomPage/JoinRoomTitle.js","JoinRoomPage/JoinRoomInputs.js","JoinRoomPage/OnlyWithAudioCheckbox.js","resources/images/check.png","JoinRoomPage/ErrorMessage.js","JoinRoomPage/JoinRoomButtons.js","environment/environment.js","utils/api.js","JoinRoomPage/JoinRoomContent.js","JoinRoomPage/JoinRoomPage.js","RoomPage/ChatSection/ChatLabel.js","RoomPage/ChatSection/Messages.js","resources/images/sendMessageButton.svg","store/reducer.js","store/store.js","utils/directMessages.js","utils/wss.js","utils/turn.js","RoomPage/ChatSection/NewMessage.js","RoomPage/ChatSection/ChatSection.js","RoomPage/ParticipantsSection/ParticipantsLabel.js","RoomPage/ParticipantsSection/Participants.js","RoomPage/ParticipantsSection/ParticipantsSection.js","resources/images/camera.svg","resources/images/cameraOff.svg","RoomPage/VideoSection/CameraButton.js","RoomPage/VideoSection/LeaveRoomButton.js","resources/images/mic.svg","resources/images/micOff.svg","RoomPage/VideoSection/MicButton.js","resources/images/switchToScreenSharing.svg","RoomPage/VideoSection/LocalScreenSharingPreview.js","RoomPage/VideoSection/SwitchToScreenSharingButton.js","RoomPage/VideoSection/VideoButtons.js","RoomPage/VideoSection/VideoSection.js","RoomPage/RoomLabel.js","RoomPage/Overlay.js","Popup/ErrorPopup.js","RoomPage/RoomPage.js","App.js","serviceWorker.js","index.js"],"names":["localStream","ConnectingButton","createRoomButton","buttonText","onClickHandler","buttonClass","className","onClick","ConnectingButtons","history","useHistory","push","Actions","SET_IS_ROOM_HOST","SET_CONNECT_ONLY_WITH_AUDIO","SET_IDENTITY","SET_ROOM_ID","SET_SHOW_OVERLAY","SET_PARTICIPANTS","SET_MESSAGES","SET_ACTIVE_CONVERSATION","SET_DIRECT_CHAT_HISTORY","SET_SOCKET_ID","SET_VALID","setIsRoomHost","isRoomHost","type","setRoomId","roomId","setShowOverlay","showOverlay","setValid","text","setDirectChatHistory","directChatHistory","connect","dispatch","setIsRoomHostAction","useEffect","src","alt","JoinRoomTitle","titleText","Input","placeholder","value","changeHandler","onChange","JoinRoomInputs","props","roomIdValue","setRoomIdValue","nameValue","setNameValue","event","target","OnlyWithAudioCheckbox","connectOnlyWithAudio","setConnectOnlyWithAudio","ErrorMessage","errorMessage","Button","cancelButton","JoinRoomButtons","handleJoinRoom","successButtonText","environment","getRoomExists","axios","get","response","data","getTURNCredentials","state","onlyWithAudio","setIdentityAction","identity","setIdentity","setRoomIdAction","useState","setErrorMessage","createRoom","joinRoom","responseMessage","roomExists","full","search","useLocation","URLSearchParams","ChatLabel","Message","author","content","sameAuthor","messageCreatedByMe","alignClass","authorText","contentAdditionalStyles","messages","map","message","index","initState","participants","activeConversation","socketId","valid","reducer","action","store","configureStore","appendMessageToChatHistory","userSocketId","chatHistory","getState","userChatHistory","find","h","newDirectMessage","isAuthor","messageContent","newUserChatHistory","newChatHistory","filter","socket","connectWithSocketIOServer","io","on","console","log","id","connectedUsers","connUserSocketId","webRTCHandler","emit","receiverSocketId","authorSocketId","appendNewMessageToChatHistory","createNewRoom","onlyAudio","TURNIceServers","fetchTURNCredentials","api","responseData","token","iceServers","defaultConstraints","audio","video","width","height","onlyAudioConstraints","GetLocalPreviewAndInitRoomConnection","constraints","navigator","mediaDevices","getUserMedia","then","stream","showLocalVideoPreview","wss","catch","err","peers","streams","getConfiguration","turnIceServers","urls","warn","prepareNewPeerConnection","isInitiator","configuration","Peer","initiator","config","channelName","signal","addStream","messageData","JSON","parse","appendNewMessage","handleSignalingData","removePeerConnection","videoContainer","document","getElementById","videoEl","srcObject","getTracks","forEach","t","stop","removeChild","parentNode","destroy","videosContainer","classList","add","createElement","videoElement","autoplay","muted","onloadedmetadata","play","appendChild","getAudioOnlyLabel","addEventListener","contains","remove","participant","p","style","position","labelContainer","label","innerHTML","toggleScreenShare","isScreenSharingActive","screenSharingStream","switchVideoTracks","socket_id","index2","kind","replaceTrack","setMessages","NewMessage","setMessage","sendMessage","length","stringifiedMessageData","stringify","send","onKeyDown","key","preventDefault","SendMessageButton","ChatSection","ParticipantsLabel","SingleParticipant","lastItem","setActiveConversationAction","setActiveConversation","ParticipantsSection","CameraButton","isLocalVideoDisabled","setIsLocalVideoDisabled","CameraButtonImgOff","CameraButtonImg","isDisabled","getVideoTracks","enabled","LeaveRoomButton","siteUrl","window","location","origin","href","MicButton","isMicMuted","setIsMicMuted","MicButtonImgOff","MicButtonImg","isMuted","getAudioTracks","LocalScreenSharingPreview","localPreviewRef","useRef","current","autoPlay","ref","SwitchToScreenSharingButton","setIsScreenSharingActive","setScreenSharingStream","handleScreenShareToggle","getDisplayMedia","SwitchImg","VideoSection","RoomLabel","Overlay","ErrorPopup","isOpen","zIndex","show","setShow","App","path","Boolean","hostname","match","ReactDOM","render","StrictMode","serviceWorker","ready","registration","unregister"],"mappings":"mPAqBIA,E,+DCHWC,EAhBU,SAAH,GAIf,IAAD,IAHJC,wBAAgB,OAAQ,EACxBC,EAAU,EAAVA,WACAC,EAAc,EAAdA,eAEMC,EAAcH,EAChB,qBACA,mBAEJ,OACE,wBAAQI,UAAWD,EAAaE,QAASH,EAAe,SACrDD,GAGP,ECceK,EA1BW,WACxB,IAAIC,EAAUC,cAUd,OACE,sBAAKJ,UAAU,+BAA8B,UAC3C,cAAC,EAAgB,CACfH,WAAW,iBACXC,eAZqB,WACzBK,EAAQE,KAAK,aACf,IAYI,cAAC,EAAgB,CACfT,kBAAgB,EAChBC,WAAW,iBACXC,eAb2B,WAC/BK,EAAQE,KAAK,uBACf,MAeF,E,QC5BMC,EAAU,CACdC,iBAAkB,mBAClBC,4BAA6B,8BAC7BC,aAAc,eACdC,YAAa,cACbC,iBAAkB,mBAClBC,iBAAkB,mBAClBC,aAAc,eACdC,wBAAyB,0BACzBC,wBAAyB,0BACzBC,cAAe,gBACfC,UAAU,aAGCC,EAAgB,SAACC,GAC5B,MAAO,CACLC,KAAMd,EAAQC,iBACdY,aAEJ,EAgBaE,EAAY,SAACC,GACxB,MAAO,CACLF,KAAMd,EAAQI,YACdY,SAEJ,EAEaC,EAAiB,SAACC,GAC7B,MAAO,CACLJ,KAAMd,EAAQK,iBACda,cAEJ,EACaC,EAAW,SAACC,GACvB,MAAO,CACLN,KAAM,YACNM,OAEJ,EAwBaC,EAAuB,SAACC,GACnC,MAAO,CACLR,KAAMd,EAAQS,wBACda,oBAEJ,EASetB,IC7DAuB,G,MAAAA,YAAQ,MANG,SAACC,GACzB,MAAO,CACLC,oBAAqB,SAACZ,GAAU,OAAKW,EAASZ,EAAcC,GAAY,EAE5E,GAEeU,EAtBU,SAAH,GAAiC,IAA3BE,EAAmB,EAAnBA,oBAM1B,OALAC,qBAAU,WACRD,GAAoB,EAEtB,GAAG,IAGD,qBAAK/B,UAAU,8BAA6B,SAC1C,sBAAKA,UAAU,0BAAyB,UACtC,qBAAKiC,ICjBE,yzEDiBOjC,UAAU,0BAA0BkC,IAAI,QACtD,cAAC,EAAiB,QAI1B,K,OEdeC,EANO,SAAH,GAAwB,IACnCC,EAD2B,EAAVjB,WACQ,eAAiB,eAEhD,OAAO,mBAAGnB,UAAU,kBAAiB,SAAEoC,GACzC,E,uBCJMC,EAAQ,SAAH,GAA+C,IAAzCC,EAAW,EAAXA,YAAaC,EAAK,EAALA,MAAOC,EAAa,EAAbA,cACnC,OACE,uBACED,MAAOA,EACPE,SAAUD,EACVxC,UAAU,kBACVsC,YAAaA,GAGnB,EAgCeI,EA9BQ,SAACC,GACtB,IAAQC,EACND,EADMC,YAAaC,EACnBF,EADmBE,eAAgBC,EACnCH,EADmCG,UAAWC,EAC9CJ,EAD8CI,aAAc5B,EAC5DwB,EAD4DxB,WAW9D,OACE,sBAAKnB,UAAU,6BAA4B,WACvCmB,GACA,cAAC,EAAK,CACJmB,YAAY,mBACZC,MAAOK,EACPJ,cAdwB,SAACQ,GAC/BH,EAAeG,EAAMC,OAAOV,MAC9B,IAeI,cAAC,EAAK,CACJD,YAAY,kBACZC,MAAOO,EACPN,cAhBwB,SAACQ,GAC7BD,EAAaC,EAAMC,OAAOV,MAC5B,MAkBF,EClBeW,EApBe,SAAH,GAGpB,IAFLC,EAAoB,EAApBA,qBACAC,EAAuB,EAAvBA,wBAMA,OACE,sBAAKpD,UAAU,qBAAoB,UACjC,qBAAKA,UAAU,sBAAsBC,QANN,WACjCmD,GAAyBD,EAC3B,EAI6E,SACtEA,GACC,qBAAKnD,UAAU,iBAAiBiC,ICf3B,6SDe0CC,IAAI,eAGvD,mBAAGlC,UAAU,+BAA8B,0BAGjD,EETeqD,EAVM,SAAH,GAA0B,IAApBC,EAAY,EAAZA,aACtB,OACE,qBAAKtD,UAAU,0BAAyB,SACrCsD,GACC,mBAAGtD,UAAU,0BAAyB,SAAEsD,KAIhD,ECPMC,EAAS,SAAH,GAA8D,IAAxD1D,EAAU,EAAVA,WAAW,EAAD,EAAE2D,oBAAY,OAAQ,EAAE1D,EAAc,EAAdA,eAC5CC,EAAcyD,EAChB,0BACA,2BAEJ,OACE,wBAAQvD,QAASH,EAAgBE,UAAWD,EAAY,SACrDF,GAGP,EAuBe4D,EArBS,SAAH,GAAwC,IAAlCC,EAAc,EAAdA,eACnBC,EAD6C,EAAVxC,WACF,OAAS,OAE1ChB,EAAUC,cAMhB,OACE,sBAAKJ,UAAU,8BAA6B,UAC1C,cAAC,EAAM,CAACH,WAAY8D,EAAmB7D,eAAgB4D,IACvD,cAAC,EAAM,CACL7D,WAAW,SACX2D,cAAY,EACZ1D,eAVyB,WAC7BK,EAAQE,KAAK,IACf,MAYF,E,iBClCauD,EAEL,sDAFKA,EAGJ,mDCEIC,EAAa,iDAAG,WAAOvC,GAAM,iGACjBwC,IAAMC,IAAI,GAAD,OAAIH,EAAmB,wBAAgBtC,IAAU,KAAD,EAAlE,OAAR0C,EAAQ,yBACPA,EAASC,MAAI,2CACrB,gBAHyB,sCAKbC,EAAkB,iDAAG,8GACTJ,IAAMC,IAAI,GAAD,OAAIH,EAAmB,0BAAyB,KAAD,EAAjE,OAARI,EAAQ,yBACPA,EAASC,MAAI,2CACrB,kBAH8B,mCCuFhBpC,eAfc,SAACsC,GAC5B,OAAO,eACFA,EAEP,IAE0B,SAACrC,GACzB,MAAO,CACLsB,wBAAyB,SAACgB,GAAa,OACrCtC,EXtEiC,SAACsC,GACtC,MAAO,CACLhD,KAAMd,EAAQE,4BACd4D,gBAEJ,CWiEehB,CAAwBgB,GAAe,EAClDC,kBAAmB,SAACC,GAAQ,OAAKxC,EXhEV,SAACwC,GAC1B,MAAO,CACLlD,KAAMd,EAAQG,aACd6D,WAEJ,CW2D8CC,CAAYD,GAAU,EAChEE,gBAAiB,SAAClD,GAAM,OAAKQ,EAAST,EAAUC,GAAQ,EAE5D,GAEeO,EAnFS,SAACc,GACvB,IACExB,EAKEwB,EALFxB,WACAiC,EAIET,EAJFS,wBACAD,EAGER,EAHFQ,qBACAkB,EAEE1B,EAFF0B,kBACAG,EACE7B,EADF6B,gBAGF,EAAsCC,mBAAS,IAAG,mBAA3C7B,EAAW,KAAEC,EAAc,KAClC,EAAkC4B,mBAAS,IAAG,mBAAvC3B,EAAS,KAAEC,EAAY,KAC9B,EAAwC0B,mBAAS,MAAK,mBAA/CnB,EAAY,KAAEoB,EAAe,KAE9BvE,EAAUC,cAEVsD,EAAc,iDAAG,wFACQ,GAA7BW,EAAkBvB,IACd3B,EAAW,CAAD,eACZwD,IAAa,sCAEPC,IAAW,KAAD,sCAEnB,kBAPmB,mCASdA,EAAQ,iDAAG,kHACef,EAAcjB,GAAa,KAAD,EAAlDiC,EAAe,OAEbC,EAAqBD,EAArBC,WAAYC,EAASF,EAATE,KAEhBD,EACEC,EACFL,EAAgB,6CAGhBF,EAAgB5B,GAChBzC,EAAQE,KAAK,UAGfqE,EAAgB,6CACjB,2CACF,kBAhBa,mCAkBRC,EAAa,WACjBxE,EAAQE,KAAK,QACf,EAEA,OACE,qCACE,cAAC,EAAc,CACbuC,YAAaA,EACbC,eAAgBA,EAChBC,UAAWA,EACXC,aAAcA,EACd5B,WAAYA,IAEd,cAAC,EAAqB,CACpBiC,wBAAyBA,EACzBD,qBAAsBA,IAExB,cAAC,EAAY,CAACG,aAAcA,IAC5B,cAAC,EAAe,CACdI,eAAgBA,EAChBvC,WAAYA,MAIpB,ICpCeU,G,OAAAA,aAZc,SAACsC,GAC5B,OAAO,eACFA,EAEP,IAE0B,SAACrC,GACzB,MAAO,CACLC,oBAAqB,SAACZ,GAAU,OAAKW,EAASZ,EAAcC,GAAY,EAE5E,GAEeU,EAnCM,SAACc,GACpB,IAAQZ,EAAoCY,EAApCZ,oBAAqBZ,EAAewB,EAAfxB,WAEvB6D,EAASC,cAAcD,OAU7B,OARAhD,qBAAU,WACW,IAAIkD,gBAAgBF,GAAQjB,IAAI,SAEjDhC,GAAoB,EAGxB,GAAG,IAGD,qBAAK/B,UAAU,2BAA0B,SACvC,sBAAKA,UAAU,uBAAsB,UACnC,cAAC,EAAa,CAACmB,WAAYA,IAC3B,cAAC,EAAe,QAIxB,KCpBegE,EARG,WAChB,OACE,qBAAKnF,UAAU,uBAAsB,SACnC,mBAAGA,UAAU,uBAAsB,mBAGzC,ECLMoF,EAAU,SAAH,GAA6D,IAAvDC,EAAM,EAANA,OAAQC,EAAO,EAAPA,QAASC,EAAU,EAAVA,WAAYC,EAAkB,EAAlBA,mBACxCC,EAAaD,EACf,sBACA,qBAEEE,EAAaF,EAAqB,MAAQH,EAE1CM,EAA0BH,EAC5B,uBACA,sBAEJ,OACE,sBAAKxF,UAAS,4BAAuByF,GAAa,WAC9CF,GAAc,mBAAGvF,UAAU,gBAAe,SAAE0F,IAC9C,mBAAG1F,UAAS,0BAAqB2F,GAA0B,SAAEL,MAGnE,EA6BezD,eANc,SAACsC,GAC5B,OAAO,eACFA,EAEP,GAEetC,EA3BE,SAAH,GAAsB,IAAhB+D,EAAQ,EAARA,SAClB,OACE,qBAAK5F,UAAU,qBAAoB,SAChC4F,EAASC,KAAI,SAACC,EAASC,GACtB,IAAMR,EACJQ,EAAQ,GAAKD,EAAQxB,WAAasB,EAASG,EAAQ,GAAGzB,SAExD,OACE,cAAC,EAAO,CAENe,OAAQS,EAAQxB,SAChBgB,QAASQ,EAAQR,QACjBC,WAAYA,EACZC,mBAAoBM,EAAQN,oBAAmB,UAJvCM,EAAQR,SAAO,OAAGS,GAOhC,KAGN,ICzCe,MAA0B,8C,gBCEnCC,EAAY,CAChB1B,SAAU,GACVnD,YAAY,EACZgC,sBAAsB,EACtB7B,OAAQ,KACRE,aAAa,EACbyE,aAAc,GACdL,SAAU,GACVM,mBAAoB,KACpBtE,kBAAmB,GACnBuE,SAAU,KACVC,OAAM,GAkEOC,EA/DC,WAAgC,IAA/BlC,EAAK,uDAAG6B,EAAWM,EAAM,uCACxC,OAAQA,EAAOlF,MACb,KAAKd,EAAQC,iBACX,OAAO,2BACF4D,GAAK,IACRhD,WAAYmF,EAAOnF,aAEvB,KAAKb,EAAQE,4BACX,OAAO,2BACF2D,GAAK,IACRhB,qBAAsBmD,EAAOlC,gBAEjC,KAAK9D,EAAQI,YACX,OAAO,2BACFyD,GAAK,IACR7C,OAAQgF,EAAOhF,SAEnB,KAAKhB,EAAQG,aACX,OAAO,2BACF0D,GAAK,IACRG,SAAUgC,EAAOhC,WAErB,KAAKhE,EAAQK,iBACX,OAAO,2BACFwD,GAAK,IACR3C,YAAa8E,EAAO9E,cAEtB,IAAK,YACH,OAAO,2BACF2C,GAAK,IACRiC,MAAOE,EAAO5E,OAEpB,KAAKpB,EAAQM,iBACX,OAAO,2BACFuD,GAAK,IACR8B,aAAcK,EAAOL,eAEzB,KAAK3F,EAAQO,aACX,OAAO,2BACFsD,GAAK,IACRyB,SAAUU,EAAOV,WAGrB,KAAKtF,EAAQQ,wBACX,OAAO,2BACFqD,GAAK,IACR+B,mBAAoBI,EAAOJ,qBAE/B,KAAK5F,EAAQS,wBACX,OAAO,2BACFoD,GAAK,IACRvC,kBAAmB0E,EAAO1E,oBAE9B,KAAKtB,EAAQU,cACX,OAAO,2BACFmD,GAAK,IACRgC,SAAUG,EAAOH,WAErB,QACE,OAAOhC,EAEb,EC1EaoC,EAAQC,YAAe,CAClCH,QAASA,IAGIE,I,QCMTE,EAA6B,SAACC,EAAczC,GAChD,IAAM0C,EAAW,YAAOJ,EAAMK,WAAWhF,mBAEnCiF,EAAkBF,EAAYG,MAAK,SAACC,GAAC,OAAKA,EAAEZ,WAAaO,CAAY,IAE3E,GAAIG,EAAiB,CACnB,IAAMG,EAAmB,CACvBC,SAAUhD,EAAKgD,SACfC,eAAgBjD,EAAKiD,eACrB5C,SAAUL,EAAKK,UAGX6C,EAAkB,2BACnBN,GAAe,IAClBF,YAAY,GAAD,mBAAME,EAAgBF,aAAW,CAAEK,MAG1CI,EAAc,sBACfT,EAAYU,QAAO,SAACN,GAAC,OAAKA,EAAEZ,WAAaO,CAAY,KAAC,CACzDS,IAGFZ,EAAMzE,SAASH,EAAqByF,GACtC,KAAO,CACL,IAAMD,EAAqB,CACzBhB,SAAUO,EACVC,YAAa,CACX,CACEM,SAAUhD,EAAKgD,SACfC,eAAgBjD,EAAKiD,eACrB5C,SAAUL,EAAKK,YAKf8C,EAAc,sBAAOT,GAAW,CAAEQ,IAExCZ,EAAMzE,SAASH,EAAqByF,GACtC,CACF,EC1CIE,EAAS,KAEAC,GAA4B,YACvCD,EAASE,YAAG5D,IAEL6D,GAAG,WAAW,WnBqEI,IAACtB,EmBpExBuB,QAAQC,IAAI,gDACZD,QAAQC,IAAIL,EAAOM,IACnBrB,EAAMzE,UnBkEkBqE,EmBlEGmB,EAAOM,GnBmE7B,CACLxG,KAAMd,EAAQU,cACdmF,amBpEF,IAEAmB,EAAOG,GAAG,WAAW,SAACxD,GACpB,IAAQ3C,EAAW2C,EAAX3C,OACRiF,EAAMzE,SAAST,EAAUC,GAC3B,IAEAgG,EAAOG,GAAG,eAAe,SAACxD,GACxB,IAAQ4D,EAAmB5D,EAAnB4D,eACRtB,EAAMzE,SnB6BD,CACLV,KAAMd,EAAQM,iBACdqF,amB/B+B4B,GACjC,IAEAP,EAAOG,GAAG,gBAAgB,SAACxD,GACzB,IAAQ6D,EAAqB7D,EAArB6D,iBAERC,GAAuCD,GAAkB,GAGzDR,EAAOU,KAAK,YAAa,CAAEF,iBAAkBA,GAC/C,IAEAR,EAAOG,GAAG,eAAe,SAACxD,GACxB8D,GAAkC9D,EACpC,IAEAqD,EAAOG,GAAG,aAAa,SAACxD,GACtB,IAAQ6D,EAAqB7D,EAArB6D,iBACRC,GAAuCD,GAAkB,EAC3D,IAEAR,EAAOG,GAAG,qBAAqB,SAACxD,GAC9B8D,GAAmC9D,EACrC,IAEAqD,EAAOG,GAAG,kBAAkB,SAACxD,IDlDc,SAACA,GAC5C,IAAQgD,EAA+ChD,EAA/CgD,SAAUgB,EAAqChE,EAArCgE,iBAAkBC,EAAmBjE,EAAnBiE,eAGlCzB,EADEQ,EACyBgB,EAEAC,EAFkBjE,EAIjD,CC2CIkE,CAA8BlE,EAChC,GACF,EAEamE,GAAgB,SAAC9D,EAAU+D,GAEtC,IAAMpE,EAAO,CACXK,WACA+D,aAGFf,EAAOU,KAAK,kBAAmB/D,EACjC,EAEaW,GAAW,SAACN,EAAUhD,EAAQ+G,GAEzC,IAAMpE,EAAO,CACX3C,SACAgD,WACA+D,aAGFf,EAAOU,KAAK,YAAa/D,EAC3B,E,oBC3EIqE,GAAiB,KAERC,GAAoB,iDAAG,gHACPC,IAAyB,KAAD,EAIlD,OAJKC,EAAY,OAEI,QAAtB,EAAIA,EAAaC,aAAK,OAAlB,EAAoBC,aACtBL,GAAiBG,EAAaC,MAAMC,YACrC,kBAEML,IAAc,2CACtB,kBARgC,mCvBG3BM,GAAqB,CACzBC,OAAO,EACPC,MAAO,CACLC,MAAO,MACPC,OAAQ,QAKNC,GAAuB,CAC3BJ,OAAO,EACPC,OAAO,GAKII,GAAoC,iDAAG,WAClD/H,EACAmD,GAAQ,iGAEC,OADThD,EAAM,+BAAG,KACT+G,EAAS,gCAEHE,KAAuB,KAAD,EAGtBY,EAAcd,EAAYY,GAAuBL,GACxDQ,UAAUC,aACNC,aAAaH,GACbI,MAAK,SAACC,GACL9B,QAAQC,IAAI,qCAEZ8B,GADA/J,EAAc8J,GAGdjD,EAAMzE,SAASP,GAAe,IAI9BJ,EACIuI,GAAkBpF,EAAU+D,GAC5BqB,GAAapF,EAAUhD,EAAQ+G,EAErC,IACCsB,OAAM,SAACC,GACPlC,QAAQC,IAAIiC,GACZrD,EAAMzE,SAASL,GAAS,GACzB,IAAG,2CAGN,gBAhCgD,wCAkC7CoI,GAAQ,CAAC,EACTC,GAAU,GAERC,GAAmB,WACvB,IAAMC,EuB9CC1B,GvBgDP,OAAI0B,EACK,CACLrB,WAAW,CACT,CACEsB,KAAM,iCACP,mBACED,MAIPtC,QAAQwC,KAAK,0BACN,CACLvB,WAAY,CACV,CACEsB,KAAM,kCAKhB,EAIaE,GAA2B,SAACrC,EAAkBsC,GACzD,IAAMC,EAAgBN,KAEtBF,GAAM/B,GAAoB,IAAIwC,KAAK,CACjCC,UAAWH,EACXI,OAAQH,EACRb,OAAQ9J,EACR+K,YATqB,cAYvBZ,GAAM/B,GAAkBL,GAAG,UAAU,SAACxD,IsBjBV,SAACA,GAC7BqD,EAAOU,KAAK,cAAe/D,EAC7B,CtBuBIyF,CALmB,CACjBgB,OAAQzG,EACR6D,iBAAkBA,GAItB,IAEA+B,GAAM/B,GAAkBL,GAAG,UAAU,SAAC+B,GACpC9B,QAAQC,IAAI,mBAEZgD,GAAUnB,EAAQ1B,GAClBgC,GAAO,sBAAOA,IAAO,CAAEN,GACzB,IAEAK,GAAM/B,GAAkBL,GAAG,QAAQ,SAACxD,GAClC,IAAM2G,EAAcC,KAAKC,MAAM7G,GAC/B8G,GAAiBH,EACnB,GACF,EAEaI,GAAsB,SAAC/G,GAElC4F,GAAM5F,EAAK6D,kBAAkB4C,OAAOzG,EAAKyG,OAC3C,EAEaO,GAAuB,SAAChH,GACnC,IAAQkC,EAAalC,EAAbkC,SACF+E,EAAiBC,SAASC,eAAejF,GACzCkF,EAAUF,SAASC,eAAe,GAAD,OAAIjF,EAAQ,WAE/C+E,GAAkBG,IACLA,EAAQC,UAAUC,YAE1BC,SAAQ,SAACC,GAAC,OAAKA,EAAEC,MAAM,IAE9BL,EAAQC,UAAY,KACpBJ,EAAeS,YAAYN,GAE3BH,EAAeU,WAAWD,YAAYT,GAElCrB,GAAM1D,IACR0D,GAAM1D,GAAU0F,iBAEXhC,GAAM1D,GAEjB,EAGMsD,GAAwB,SAACD,GAC7B,IAAMsC,EAAkBX,SAASC,eAAe,iBAChDU,EAAgBC,UAAUC,IAAI,wBAC9B,IAAMd,EAAiBC,SAASc,cAAc,OAC9Cf,EAAea,UAAUC,IAAI,yBAC7B,IAAME,EAAef,SAASc,cAAc,SAC5CC,EAAaC,UAAW,EACxBD,EAAaE,OAAQ,EACrBF,EAAaZ,UAAY9B,EAEzB0C,EAAaG,iBAAmB,WAC9BH,EAAaI,MACf,EAEApB,EAAeqB,YAAYL,GAEvB3F,EAAMK,WAAWzD,sBACnB+H,EAAeqB,YAAYC,MAG7BV,EAAgBS,YAAYrB,EAC9B,EAEMP,GAAY,SAACnB,EAAQ1B,GAEzB,IAAMgE,EAAkBX,SAASC,eAAe,iBAC1CF,EAAiBC,SAASc,cAAc,OAC9Cf,EAAetD,GAAKE,EAEpBoD,EAAea,UAAUC,IAAI,yBAC7B,IAAME,EAAef,SAASc,cAAc,SAC5CC,EAAaC,UAAW,EACxBD,EAAaZ,UAAY9B,EACzB0C,EAAatE,GAAE,UAAME,EAAgB,UAErCoE,EAAaG,iBAAmB,WAC9BH,EAAaI,MACf,EAEAJ,EAAaO,iBAAiB,SAAS,WACjCP,EAAaH,UAAUW,SAAS,eAClCR,EAAaH,UAAUY,OAAO,eAE9BT,EAAaH,UAAUC,IAAI,cAE/B,IAEAd,EAAeqB,YAAYL,GAG3B,IAEMU,EAFerG,EAAMK,WAAWX,aAELa,MAAK,SAAC+F,GAAC,OAAKA,EAAE1G,WAAa2B,CAAgB,IAC5EJ,QAAQC,IAAIiF,GACG,OAAXA,QAAW,IAAXA,KAAavE,UACf6C,EAAeqB,YAAYC,GAAkBI,EAAYtI,WAEzD4G,EAAe4B,MAAMC,SAAW,SAGlCjB,EAAgBS,YAAYrB,EAC9B,EAEMsB,GAAoB,WAAoB,IAAnBlI,EAAQ,uDAAG,GAC9B0I,EAAiB7B,SAASc,cAAc,OAC9Ce,EAAejB,UAAUC,IAAI,8BAE7B,IAAMiB,EAAQ9B,SAASc,cAAc,KAKrC,OAJAgB,EAAMlB,UAAUC,IAAI,yBACpBiB,EAAMC,UAAS,qBAAiB5I,GAEhC0I,EAAeT,YAAYU,GACpBD,CACT,EAYaG,GAAoB,SAC/BC,GAEI,IADJC,EAAmB,uDAAG,KAGpBC,GADEF,EACgB1N,EAEA2N,EAEtB,EAEMC,GAAoB,SAAC9D,GACzB,IAAK,IAAI+D,KAAa1D,GACpB,IAAK,IAAI9D,KAAS8D,GAAM0D,GAAWzD,QAAQ,GAAGyB,YAC5C,IAAK,IAAIiC,KAAUhE,EAAO+B,YACxB,GACE1B,GAAM0D,GAAWzD,QAAQ,GAAGyB,YAAYxF,GAAO0H,OAC/CjE,EAAO+B,YAAYiC,GAAQC,KAC3B,CACA5D,GAAM0D,GAAWG,aACf7D,GAAM0D,GAAWzD,QAAQ,GAAGyB,YAAYxF,GACxCyD,EAAO+B,YAAYiC,GACnB3D,GAAM0D,GAAWzD,QAAQ,IAE3B,KACF,CAIR,EAGMiB,GAAmB,SAACH,GACxB,IAAMhF,EAAWW,EAAMK,WAAWhB,SAClCW,EAAMzE,SG5MmB,SAAC8D,GAC1B,MAAO,CACLxE,KAAMd,EAAQO,aACd+E,WAEJ,CHuMiB+H,CAAY,GAAD,mBAAK/H,GAAQ,CAAEgF,KAC3C,EwB9NegD,GA1CI,WACjB,MAA8BnJ,mBAAS,IAAG,mBAAnCqB,EAAO,KAAE+H,EAAU,KAepBC,EAAc,WACdhI,EAAQiI,OAAS,KxByPkB,SAAC7G,GAE1C,IAAM5C,EAAWiC,EAAMK,WAAWtC,SAQlCyG,GANyB,CACvBzF,QAAS4B,EACT5C,WACAkB,oBAAoB,IAKtB,IAAMoF,EAAc,CAClBtF,QAAS4B,EACT5C,YAGI0J,EAAyBnD,KAAKoD,UAAUrD,GAC9C,IAAK,IAAIzE,KAAY0D,GACnBA,GAAM1D,GAAU+H,KAAKF,EAEzB,CwB7QMjG,CAA0CjC,GAC1C+H,EAAW,IAEf,EAEA,OACE,sBAAK7N,UAAU,wBAAuB,UACpC,uBACEA,UAAU,oBACVuC,MAAOuD,EACPrD,SAzBmB,SAACO,GACxB6K,EAAW7K,EAAMC,OAAOV,MAC1B,EAwBMD,YAAY,wBACZlB,KAAK,OACL+M,UAxBmB,SAACnL,GACN,UAAdA,EAAMoL,MACRpL,EAAMqL,iBAGNP,IAEJ,IAmBI,qBACE9N,UAAU,qBACViC,IAAKqM,EACLrO,QAAS6N,EAAa5L,IAAI,UAIlC,EC7BeqM,GAVK,WAClB,OACE,sBAAKvO,UAAU,yBAAwB,UACrC,cAAC,EAAS,IACV,cAAC,EAAQ,IACT,cAAC,GAAU,MAGjB,ECHewO,GARW,WACxB,OACE,qBAAKxO,UAAU,+BAA8B,SAC3C,mBAAGA,UAAU,+BAA8B,2BAGjD,ECJMyO,GAAoB,SAAC9L,GACzB,IACE2B,EAKE3B,EALF2B,SACAoK,EAIE/L,EAJF+L,SACA9B,EAGEjK,EAHFiK,YACA+B,EAEEhM,EAFFgM,4BACAxI,EACExD,EADFwD,SASF,OACE,qCACE,mBAAGnG,UAAU,yBAAyBC,QARV,WAC1B2M,EAAYzG,WAAaA,GAC3BwI,EAA4B/B,EAEhC,EAI2E,SACpEtI,KAEDoK,GAAY,sBAAM1O,UAAU,kCAGpC,EAsCe6B,gBAbc,SAACsC,GAC5B,OAAO,eACFA,EAEP,IAE0B,SAACrC,GACzB,MAAO,CACL6M,4BAA6B,SAACzI,GAAkB,OAC9CpE,ExBS+B,SAACoE,GACpC,MAAO,CACL9E,KAAMd,EAAQQ,wBACdoF,qBAEJ,CwBde0I,CAAsB1I,GAAoB,EAEzD,GAEerE,EApCM,SAAH,GAIX,IAHLoE,EAAY,EAAZA,aACA0I,EAA2B,EAA3BA,4BACAxI,EAAQ,EAARA,SAEA,OACE,qBAAKnG,UAAU,yBAAwB,SACpCiG,EAAaJ,KAAI,SAAC+G,EAAa7G,GAC9B,OACE,cAAC,GAAiB,CAEhB2I,SAAUzI,EAAa8H,SAAWhI,EAAQ,EAC1C6G,YAAaA,EACbtI,SAAUsI,EAAYtI,SACtBqK,4BAA6BA,EAC7BxI,SAAUA,GALLyG,EAAYtI,SAQvB,KAGN,ICnCeuK,GAVa,WAC1B,OACE,sBAAK7O,UAAU,iCAAgC,UAC7C,cAAC,GAAiB,IAClB,cAAC,GAAY,MAInB,ECbe,OAA0B,mCCA1B,OAA0B,sCC2B1B8O,GArBM,WACnB,MAAwDrK,oBAAS,GAAM,mBAAhEsK,EAAoB,KAAEC,EAAuB,KAQpD,OACE,qBAAKhP,UAAU,yBAAwB,SACrC,qBACEiC,IAAK8M,EAAuBE,GAAqBC,GACjDlP,UAAU,qBACVC,QAX4B,W/B4NR,IAACkP,I+B3NEJ,E/B4N7BrP,EAAY0P,iBAAiB,GAAGC,UAAUF,E+B1NxCH,GAAyBD,EAC3B,EAQM7M,IAAI,SAIZ,ECReoN,GAfS,WAMtB,OACE,qBAAKtP,UAAU,yBAAwB,SACrC,wBAAQA,UAAU,mBAAmBC,QAPT,WAC9B,IAAMsP,EAAUC,OAAOC,SAASC,OAChCF,OAAOC,SAASE,KAAOJ,CACzB,EAI0E,yBAK5E,ECfe,OAA0B,gCCA1B,OAA0B,mCC0B1BK,GArBG,WAChB,MAAoCnL,oBAAS,GAAM,mBAA5CoL,EAAU,KAAEC,EAAa,KAQhC,OACE,qBAAK9P,UAAU,yBAAwB,SACrC,qBACEiC,IAAK4N,EAAaE,GAAkBC,GACpC/P,QAVyB,WnCyNR,IAACgQ,ImCxNEJ,EnCyN1BnQ,EAAYwQ,iBAAiB,GAAGb,UAAUY,EmCvNxCH,GAAeD,EACjB,EAOM7P,UAAU,qBACVkC,IAAI,SAIZ,ECxBe,OAA0B,kDCsB1BiO,GApBmB,SAAH,GAAoB,IAAd3G,EAAM,EAANA,OAC7B4G,EAAkBC,mBAYxB,OAVArO,qBAAU,WACR,IAAM8G,EAAQsH,EAAgBE,QAE9BxH,EAAMwC,UAAY9B,EAElBV,EAAMuD,iBAAmB,WACvBvD,EAAMwD,MACR,CACF,GAAG,CAAC9C,IAGF,qBAAKxJ,UAAU,6BAA4B,SACzC,uBAAOoM,OAAK,EAACmE,UAAQ,EAACC,IAAKJ,KAGjC,ECfMjH,GAAc,CAClBN,OAAO,EACPC,OAAO,GAmDM2H,GAhDqB,WAClC,MAA0DhM,oBAAS,GAAM,mBAAlE2I,EAAqB,KAAEsD,EAAwB,KACtD,EAAsDjM,mBAAS,MAAK,mBAA7D4I,EAAmB,KAAEsD,EAAsB,KAE5CC,EAAuB,iDAAG,iGACzBxD,EAAsB,CAAD,gBACP,OAAb5D,EAAS,KAAK,EAAD,gBAEAJ,UAAUC,aAAawH,gBAAgB1H,IAAa,KAAD,EAAlEK,EAAM,uDAEN9B,QAAQC,IACN,sEACA,QAEA6B,IACFmH,EAAuBnH,GAEvBzB,GAAgCqF,EAAuB5D,GACvDkH,GAAyB,IAE1B,wBAED3I,GAAgCqF,GAChCsD,GAAyB,GAGzBrD,EAAoB9B,YAAYC,SAAQ,SAACC,GAAC,OAAKA,EAAEC,MAAM,IACvDiF,EAAuB,MAAM,yDAEhC,kBAzB4B,mCA2B7B,OACE,qCACE,qBAAK3Q,UAAU,yBAAwB,SACrC,qBACEiC,IAAK6O,GACL7Q,QAAS2Q,EACT5Q,UAAU,qBACZkC,IAAI,UAGLkL,GACC,cAAC,GAAyB,CAAC5D,OAAQ6D,MAI3C,EC7BexL,gBANc,SAACsC,GAC5B,OAAO,eACFA,EAEP,GAEetC,EAnBM,SAACc,GACpB,IAAQQ,EAAyBR,EAAzBQ,qBAER,OACE,sBAAKnD,UAAU,0BAAyB,UACtC,cAAC,GAAS,KACRmD,GAAwB,cAAC,GAAY,IACvC,cAAC,GAAe,KACdA,GAAwB,cAAC,GAA2B,MAG5D,ICRe4N,GARM,WACnB,OACE,qBAAK/Q,UAAU,0BAAyB,SACtC,cAAC,GAAY,KAGnB,E,SCKegR,GAXG,SAAH,GAAoB,IAAd1P,EAAM,EAANA,OACnB,OACE,qBAAKtB,UAAU,aAAY,SACzB,oBAAGA,UAAU,uBAAsB,iBAAMsB,EACzC,cAAC,mBAAe,CAACI,KAAMJ,EAAO,SAC5B,mDAIR,ECFe2P,GARC,WACd,OACE,qBAAKjR,UAAU,oBAAmB,SAChC,qBAAKA,UAAU,YAGrB,ECwBekR,I,OA5BI,SAAH,GAAkB,IAAbC,EAAM,EAANA,OAOjB,OACI,qBAAKnR,UAAS,qBAAgBmR,EAAS,SAAW,IAAK,SACnD,qBAAKnR,UAAU,6BAA4B,SAKvC,sBAAKA,UAAU,YAAW,UACtB,oBAAGA,UAAU,YAAW,cAAE,4BAAI,+EAAiF,oCAC/G,qBAAKA,UAAU,cAAa,SAIvB,wBAAQ8M,MAAO,CAACsE,OAAO,kBAAmBhQ,KAAK,MAAMnB,QAlB1D,WACRuP,OAAOC,SAASE,KAAK,kDACrBjI,QAAQC,IAAI,QACpB,EAe6FzF,IAAI,MAAMlC,UAAU,WAAU,8BAM/H,GC+Be6B,I,OAAAA,aANc,SAACsC,GAC5B,OAAO,eACFA,EAEP,GAEetC,EAjDE,SAAH,GAOP,IANLP,EAAM,EAANA,OACAgD,EAAQ,EAARA,SACAnD,EAAU,EAAVA,WACAK,EAAW,EAAXA,YACA2B,EAAoB,EAApBA,qBACAiD,EAAK,EAALA,MAEA,EAAwB3B,oBAAS,GAAM,mBAAhC4M,EAAI,KAAEC,EAAO,KAuBpB,OArBAtP,qBAAU,WACR,GAAKb,GAAeG,EAInByG,GACG5G,EACAmD,EACAhD,EACA6B,GAEFuE,QAAQC,IAAIvB,OAVc,CAC1B,IAAMmJ,EAAUC,OAAOC,SAASC,OAChCF,OAAOC,SAASE,KAAOJ,CACzB,CAUF,GAAG,IACLvN,qBAAU,WACJoE,GAAUjD,GACZmO,GAAQ,EAEZ,GAAE,CAAClL,EAAMjD,IAGL,sBAAKnD,UAAU,iBAAgB,UAC7B,cAAC,GAAmB,IACpB,cAAC,GAAU,CAACmR,OAAQE,IACpB,cAAC,GAAY,IACb,cAAC,GAAW,IACZ,cAAC,GAAS,CAAC/P,OAAQA,IAClBE,GAAe,cAAC,GAAO,MAG9B,K,OCtBe+P,OAtBf,WAKE,OAJAvP,qBAAU,WACRuF,IACF,GAAG,IAGD,cAAC,IAAM,UACL,eAAC,IAAM,WACL,cAAC,IAAK,CAACiK,KAAK,aAAY,SACtB,cAAC,EAAY,MAEf,cAAC,IAAK,CAACA,KAAK,QAAO,SACjB,cAAC,GAAQ,MAEX,cAAC,IAAK,CAACA,KAAK,IAAG,SACb,cAAC,EAAgB,UAK3B,ECjBoBC,QACW,cAA7BjC,OAAOC,SAASiC,UAEe,UAA7BlC,OAAOC,SAASiC,UAEhBlC,OAAOC,SAASiC,SAASC,MACvB,2DCVNC,IAASC,OACP,cAAC,IAAMC,WAAU,UACf,cAAC,IAAQ,CAACvL,MAAOA,EAAM,SACrB,cAAC,GAAG,QAGR4E,SAASC,eAAe,SDqHpB,kBAAmBhC,WACrBA,UAAU2I,cAAcC,MAAMzI,MAAK,SAAC0I,GAClCA,EAAaC,YACf,G","file":"static/js/main.99b2cc06.chunk.js","sourcesContent":["import { setShowOverlay, setMessages,setValid } from \"../store/actions\";\r\nimport store from \"../store/store\";\r\nimport * as wss from \"./wss\";\r\nimport Peer from \"simple-peer\";\r\nimport { fetchTURNCredentials, getTurnIceServers } from \"./turn\";\r\n\r\n\r\nconst defaultConstraints = {\r\n  audio: true,\r\n  video: {\r\n    width: \"480\",\r\n    height: \"360\",\r\n  },\r\n};\r\n\r\n\r\nconst onlyAudioConstraints = {\r\n  audio: true,\r\n  video: false,\r\n};\r\n\r\nlet localStream;\r\n\r\nexport const GetLocalPreviewAndInitRoomConnection = async (\r\n  isRoomHost,\r\n  identity,\r\n  roomId = null,\r\n  onlyAudio\r\n) => {\r\n  await fetchTURNCredentials();\r\n\r\n  // let history = useHistory();\r\n  const constraints = onlyAudio ? onlyAudioConstraints : defaultConstraints;\r\n navigator.mediaDevices\r\n    .getUserMedia(constraints)  \r\n    .then((stream) => {\r\n      console.log(\"successfuly received local stream\");\r\n      localStream = stream;\r\n      showLocalVideoPreview(localStream);\r\n      // dispatch an action to hide overlay\r\n      store.dispatch(setShowOverlay(false));\r\n     \r\n\r\n      \r\n      isRoomHost\r\n        ? wss.createNewRoom(identity, onlyAudio)\r\n        : wss.joinRoom(identity, roomId, onlyAudio);\r\n       \r\n    })\r\n    .catch((err) => {\r\n     console.log(err)\r\n     store.dispatch(setValid(false));\r\n    });\r\n   \r\n\r\n};\r\n\r\nlet peers = {};\r\nlet streams = [];\r\n\r\nconst getConfiguration = () => {\r\n  const turnIceServers = getTurnIceServers();\r\n\r\n  if (turnIceServers) {\r\n    return {\r\n      iceServers: [\r\n        {\r\n          urls: \"stun:stun.l.google.com:19302\",\r\n        },\r\n        ...turnIceServers,\r\n      ],\r\n    };\r\n  } else {\r\n    console.warn(\"Using only STUN server\");\r\n    return {\r\n      iceServers: [\r\n        {\r\n          urls: \"stun:stun.l.google.com:19302\",\r\n        },\r\n      ],\r\n    };\r\n  }\r\n};\r\n\r\nconst messengerChannel = \"messenger\";\r\n\r\nexport const prepareNewPeerConnection = (connUserSocketId, isInitiator) => {\r\n  const configuration = getConfiguration();\r\n\r\n  peers[connUserSocketId] = new Peer({\r\n    initiator: isInitiator,\r\n    config: configuration,\r\n    stream: localStream,\r\n    channelName: messengerChannel,\r\n  });\r\n\r\n  peers[connUserSocketId].on(\"signal\", (data) => {\r\n    // webRTC offer, webRTC Answer (SDP informations), ice candidates\r\n\r\n    const signalData = {\r\n      signal: data,\r\n      connUserSocketId: connUserSocketId,\r\n    };\r\n\r\n    wss.signalPeerData(signalData);\r\n  });\r\n\r\n  peers[connUserSocketId].on(\"stream\", (stream) => {\r\n    console.log(\"new stream came\");\r\n\r\n    addStream(stream, connUserSocketId);\r\n    streams = [...streams, stream];\r\n  });\r\n\r\n  peers[connUserSocketId].on(\"data\", (data) => {\r\n    const messageData = JSON.parse(data);\r\n    appendNewMessage(messageData);\r\n  });\r\n};\r\n\r\nexport const handleSignalingData = (data) => {\r\n  //add signaling data to peer connection\r\n  peers[data.connUserSocketId].signal(data.signal);\r\n};\r\n\r\nexport const removePeerConnection = (data) => {\r\n  const { socketId } = data;\r\n  const videoContainer = document.getElementById(socketId);\r\n  const videoEl = document.getElementById(`${socketId}-video`);\r\n\r\n  if (videoContainer && videoEl) {\r\n    const tracks = videoEl.srcObject.getTracks();\r\n\r\n    tracks.forEach((t) => t.stop());\r\n\r\n    videoEl.srcObject = null;\r\n    videoContainer.removeChild(videoEl);\r\n\r\n    videoContainer.parentNode.removeChild(videoContainer);\r\n\r\n    if (peers[socketId]) {\r\n      peers[socketId].destroy();\r\n    }\r\n    delete peers[socketId];\r\n  }\r\n};\r\n\r\n////////////////////////////////// UI Videos //////////////////////////////////\r\nconst showLocalVideoPreview = (stream) => {\r\n  const videosContainer = document.getElementById(\"videos_portal\");\r\n  videosContainer.classList.add(\"videos_portal_styles\");\r\n  const videoContainer = document.createElement(\"div\");\r\n  videoContainer.classList.add(\"video_track_container\");\r\n  const videoElement = document.createElement(\"video\");\r\n  videoElement.autoplay = true;\r\n  videoElement.muted = true;\r\n  videoElement.srcObject = stream;\r\n\r\n  videoElement.onloadedmetadata = () => {\r\n    videoElement.play();\r\n  };\r\n\r\n  videoContainer.appendChild(videoElement);\r\n\r\n  if (store.getState().connectOnlyWithAudio) {\r\n    videoContainer.appendChild(getAudioOnlyLabel());\r\n  }\r\n\r\n  videosContainer.appendChild(videoContainer);\r\n};\r\n\r\nconst addStream = (stream, connUserSocketId) => {\r\n  //display incoming stream\r\n  const videosContainer = document.getElementById(\"videos_portal\");\r\n  const videoContainer = document.createElement(\"div\");\r\n  videoContainer.id = connUserSocketId;\r\n\r\n  videoContainer.classList.add(\"video_track_container\");\r\n  const videoElement = document.createElement(\"video\");\r\n  videoElement.autoplay = true;\r\n  videoElement.srcObject = stream;\r\n  videoElement.id = `${connUserSocketId}-video`;\r\n\r\n  videoElement.onloadedmetadata = () => {\r\n    videoElement.play();\r\n  };\r\n\r\n  videoElement.addEventListener(\"click\", () => {\r\n    if (videoElement.classList.contains(\"full_screen\")) {\r\n      videoElement.classList.remove(\"full_screen\");\r\n    } else {\r\n      videoElement.classList.add(\"full_screen\");\r\n    }\r\n  });\r\n\r\n  videoContainer.appendChild(videoElement);\r\n\r\n  // check if other user connected only with audio\r\n  const participants = store.getState().participants;\r\n\r\n  const participant = participants.find((p) => p.socketId === connUserSocketId);\r\n  console.log(participant);\r\n  if (participant?.onlyAudio) {\r\n    videoContainer.appendChild(getAudioOnlyLabel(participant.identity));\r\n  } else {\r\n    videoContainer.style.position = \"static\";\r\n  }\r\n\r\n  videosContainer.appendChild(videoContainer);\r\n};\r\n\r\nconst getAudioOnlyLabel = (identity = \"\") => {\r\n  const labelContainer = document.createElement(\"div\");\r\n  labelContainer.classList.add(\"label_only_audio_container\");\r\n\r\n  const label = document.createElement(\"p\");\r\n  label.classList.add(\"label_only_audio_text\");\r\n  label.innerHTML = `Only audio ${identity}`;\r\n\r\n  labelContainer.appendChild(label);\r\n  return labelContainer;\r\n};\r\n\r\n////////////////////////////////// Buttons logic //////////////////////////////////\r\n\r\nexport const toggleMic = (isMuted) => {\r\n  localStream.getAudioTracks()[0].enabled = isMuted ? true : false;\r\n};\r\n\r\nexport const toggleCamera = (isDisabled) => {\r\n  localStream.getVideoTracks()[0].enabled = isDisabled ? true : false;\r\n};\r\n\r\nexport const toggleScreenShare = (\r\n  isScreenSharingActive,\r\n  screenSharingStream = null\r\n) => {\r\n  if (isScreenSharingActive) {\r\n    switchVideoTracks(localStream);\r\n  } else {\r\n    switchVideoTracks(screenSharingStream);\r\n  }\r\n};\r\n\r\nconst switchVideoTracks = (stream) => {\r\n  for (let socket_id in peers) {\r\n    for (let index in peers[socket_id].streams[0].getTracks()) {\r\n      for (let index2 in stream.getTracks()) {\r\n        if (\r\n          peers[socket_id].streams[0].getTracks()[index].kind ===\r\n          stream.getTracks()[index2].kind\r\n        ) {\r\n          peers[socket_id].replaceTrack(\r\n            peers[socket_id].streams[0].getTracks()[index],\r\n            stream.getTracks()[index2],\r\n            peers[socket_id].streams[0]\r\n          );\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n////////////////////////////////// Messages /////////////////////////////////////\r\nconst appendNewMessage = (messageData) => {\r\n  const messages = store.getState().messages;\r\n  store.dispatch(setMessages([...messages, messageData]));\r\n};\r\n\r\nexport const sendMessageUsingDataChannel = (messageContent) => {\r\n  // append this message locally\r\n  const identity = store.getState().identity;\r\n\r\n  const localMessageData = {\r\n    content: messageContent,\r\n    identity,\r\n    messageCreatedByMe: true,\r\n  };\r\n\r\n  appendNewMessage(localMessageData);\r\n\r\n  const messageData = {\r\n    content: messageContent,\r\n    identity,\r\n  };\r\n\r\n  const stringifiedMessageData = JSON.stringify(messageData);\r\n  for (let socketId in peers) {\r\n    peers[socketId].send(stringifiedMessageData);\r\n  }\r\n};\r\n","import React from \"react\";\r\n\r\nconst ConnectingButton = ({\r\n  createRoomButton = false,\r\n  buttonText,\r\n  onClickHandler,\r\n}) => {\r\n  const buttonClass = createRoomButton\r\n    ? \"create_room_button\"\r\n    : \"join_room_button\";\r\n\r\n  return (\r\n    <button className={buttonClass} onClick={onClickHandler}>\r\n      {buttonText}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default ConnectingButton;\r\n","import React from \"react\";\r\nimport ConnectingButton from \"./ConnectingButton\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst ConnectingButtons = () => {\r\n  let history = useHistory();\r\n\r\n  const pushToJoinRoomPage = () => {\r\n    history.push(\"/join-room\");\r\n  };\r\n\r\n  const pushToJoinRoomPageAsHost = () => {\r\n    history.push(\"/join-room?host=true\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"connecting_buttons_container\">\r\n      <ConnectingButton\r\n        buttonText=\"Join a meeting\"\r\n        onClickHandler={pushToJoinRoomPage}\r\n      />\r\n      <ConnectingButton\r\n        createRoomButton\r\n        buttonText=\"Host a meeting\"\r\n        onClickHandler={pushToJoinRoomPageAsHost}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConnectingButtons;\r\n","const Actions = {\r\n  SET_IS_ROOM_HOST: \"SET_IS_ROOM_HOST\",\r\n  SET_CONNECT_ONLY_WITH_AUDIO: \"SET_CONNECT_ONLY_WITH_AUDIO\",\r\n  SET_IDENTITY: \"SET_IDENTITY\",\r\n  SET_ROOM_ID: \"SET_ROOM_ID\",\r\n  SET_SHOW_OVERLAY: \"SET_SHOW_OVERLAY\",\r\n  SET_PARTICIPANTS: \"SET_PARTICIPANTS\",\r\n  SET_MESSAGES: \"SET_MESSAGES\",\r\n  SET_ACTIVE_CONVERSATION: 'SET_ACTIVE_CONVERSATION',\r\n  SET_DIRECT_CHAT_HISTORY: 'SET_DIRECT_CHAT_HISTORY',\r\n  SET_SOCKET_ID: 'SET_SOCKET_ID',\r\n  SET_VALID:'SET_VALID'\r\n};\r\n\r\nexport const setIsRoomHost = (isRoomHost) => {\r\n  return {\r\n    type: Actions.SET_IS_ROOM_HOST,\r\n    isRoomHost,\r\n  };\r\n};\r\n\r\nexport const setConnectOnlyWithAudio = (onlyWithAudio) => {\r\n  return {\r\n    type: Actions.SET_CONNECT_ONLY_WITH_AUDIO,\r\n    onlyWithAudio,\r\n  };\r\n};\r\n\r\nexport const setIdentity = (identity) => {\r\n  return {\r\n    type: Actions.SET_IDENTITY,\r\n    identity,\r\n  };\r\n};\r\n\r\nexport const setRoomId = (roomId) => {\r\n  return {\r\n    type: Actions.SET_ROOM_ID,\r\n    roomId,\r\n  };\r\n};\r\n\r\nexport const setShowOverlay = (showOverlay) => {\r\n  return {\r\n    type: Actions.SET_SHOW_OVERLAY,\r\n    showOverlay,\r\n  };\r\n};\r\nexport const setValid = (text) => {\r\n  return {\r\n    type: 'SET_VALID',\r\n    text,\r\n  };\r\n};\r\n\r\n\r\nexport const setParticipants = (participants) => {\r\n  return {\r\n    type: Actions.SET_PARTICIPANTS,\r\n    participants,\r\n  };\r\n};\r\n\r\nexport const setMessages = (messages) => {\r\n  return {\r\n    type: Actions.SET_MESSAGES,\r\n    messages,\r\n  };\r\n};\r\n\r\nexport const setActiveConversation = (activeConversation) => {\r\n  return {\r\n    type: Actions.SET_ACTIVE_CONVERSATION,\r\n    activeConversation\r\n  }\r\n}\r\n\r\nexport const setDirectChatHistory = (directChatHistory) => {\r\n  return {\r\n    type: Actions.SET_DIRECT_CHAT_HISTORY,\r\n    directChatHistory\r\n  }\r\n}\r\n\r\nexport const setSocketId = (socketId) => {\r\n  return {\r\n    type: Actions.SET_SOCKET_ID,\r\n    socketId\r\n  }\r\n}\r\n\r\nexport default Actions;\r\n","import React, { useEffect } from \"react\";\r\nimport Mu from \"../resources/images/Mu.png\"\r\nimport ConnectingButtons from \"./ConnectingButtons\";\r\nimport { connect } from \"react-redux\";\r\nimport { setIsRoomHost } from \"../store/actions\";\r\n\r\nimport \"./IntroductionPage.css\";\r\n\r\nconst IntroductionPage = ({ setIsRoomHostAction }) => {\r\n  useEffect(() => {\r\n    setIsRoomHostAction(false);\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"introduction_page_container\">\r\n      <div className=\"introduction_page_panel\">\r\n        <img src={Mu} className=\"introduction_page_image\" alt=\"img\"></img>\r\n        <ConnectingButtons />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapActionsToProps = (dispatch) => {\r\n  return {\r\n    setIsRoomHostAction: (isRoomHost) => dispatch(setIsRoomHost(isRoomHost)),\r\n  };\r\n};\r\n\r\nexport default connect(null, mapActionsToProps)(IntroductionPage);\r\n","export default \"data:image/png;base64,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\"","import React from \"react\";\r\n\r\nconst JoinRoomTitle = ({ isRoomHost }) => {\r\n  const titleText = isRoomHost ? \"Host meeting\" : \"Join meeting\";\r\n\r\n  return <p className=\"join_room_title\">{titleText}</p>;\r\n};\r\n\r\nexport default JoinRoomTitle;\r\n","import React from \"react\";\r\n\r\nconst Input = ({ placeholder, value, changeHandler }) => {\r\n  return (\r\n    <input\r\n      value={value}\r\n      onChange={changeHandler}\r\n      className=\"join_room_input\"\r\n      placeholder={placeholder}\r\n    />\r\n  );\r\n};\r\n\r\nconst JoinRoomInputs = (props) => {\r\n  const { roomIdValue, setRoomIdValue, nameValue, setNameValue, isRoomHost } =\r\n    props;\r\n\r\n  const handleRoomIdValueChange = (event) => {\r\n    setRoomIdValue(event.target.value);\r\n  };\r\n\r\n  const handleNameValueChange = (event) => {\r\n    setNameValue(event.target.value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"join_room_inputs_container\">\r\n      {!isRoomHost && (\r\n        <Input\r\n          placeholder=\"Enter meeting ID\"\r\n          value={roomIdValue}\r\n          changeHandler={handleRoomIdValueChange}\r\n        />\r\n      )}\r\n      <Input\r\n        placeholder=\"Enter your Name\"\r\n        value={nameValue}\r\n        changeHandler={handleNameValueChange}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JoinRoomInputs;\r\n","import React from \"react\";\r\nimport CheckImg from \"../resources/images/check.png\";\r\n\r\nconst OnlyWithAudioCheckbox = ({\r\n  connectOnlyWithAudio,\r\n  setConnectOnlyWithAudio,\r\n}) => {\r\n  const handleConnectionTypeChange = () => {\r\n    setConnectOnlyWithAudio(!connectOnlyWithAudio);\r\n  };\r\n\r\n  return (\r\n    <div className=\"checkbox_container\">\r\n      <div className=\"checkbox_connection\" onClick={handleConnectionTypeChange}>\r\n        {connectOnlyWithAudio && (\r\n          <img className=\"checkbox_image\" src={CheckImg} alt=\"checkbox\"></img>\r\n        )}\r\n      </div>\r\n      <p className=\"checkbox_container_paragraph\">Only audio</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnlyWithAudioCheckbox;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABiSURBVHgB7ZHBCQAgCEUdpREaoY0boREaoREawQw8hNShFLz04EOHz8MU4OMKIgZKpkTQwrJG6fMNGoRMN52fjMvltI/ryWaJy01Kn7+5k6p3JqTJ5ACLFE2uuUiriezjywAgdcf6AfL4kwAAAABJRU5ErkJggg==\"","import React from \"react\";\r\n\r\nconst ErrorMessage = ({ errorMessage }) => {\r\n  return (\r\n    <div className=\"error_message_container\">\r\n      {errorMessage && (\r\n        <p className=\"error_message_paragraph\">{errorMessage}</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ErrorMessage;\r\n","import React from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst Button = ({ buttonText, cancelButton = false, onClickHandler }) => {\r\n  const buttonClass = cancelButton\r\n    ? \"join_room_cancel_button\"\r\n    : \"join_room_success_button\";\r\n\r\n  return (\r\n    <button onClick={onClickHandler} className={buttonClass}>\r\n      {buttonText}\r\n    </button>\r\n  );\r\n};\r\n\r\nconst JoinRoomButtons = ({ handleJoinRoom, isRoomHost }) => {\r\n  const successButtonText = isRoomHost ? \"Host\" : \"Join\";\r\n\r\n  const history = useHistory();\r\n\r\n  const pushToIntroductionPage = () => {\r\n    history.push(\"/\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"join_room_buttons_container\">\r\n      <Button buttonText={successButtonText} onClickHandler={handleJoinRoom} />\r\n      <Button\r\n        buttonText=\"Cancel\"\r\n        cancelButton\r\n        onClickHandler={pushToIntroductionPage}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JoinRoomButtons;\r\n","export const environment ={\r\n\r\nBACKEND:\"https://video-meeting-backend2022.herokuapp.com/api\",\r\nSERVER : \"https://video-meeting-backend2022.herokuapp.com/\"\r\n\r\n\r\n}","import axios from \"axios\";\r\nimport {environment} from \"../environment/environment\"\r\n\r\n// const serverApi = \"https://video-meeting-backend2022.herokuapp.com/api\";\r\n\r\nexport const getRoomExists = async (roomId) => {\r\n  const response = await axios.get(`${environment.BACKEND}/room-exists/${roomId}`);\r\n  return response.data;\r\n};\r\n\r\nexport const getTURNCredentials = async () => {\r\n  const response = await axios.get(`${environment.BACKEND}/get-turn-credentials`);\r\n  return response.data;\r\n};\r\n","import React, { useState } from \"react\";\r\nimport JoinRoomInputs from \"./JoinRoomInputs\";\r\nimport { connect } from \"react-redux\";\r\nimport OnlyWithAudioCheckbox from \"./OnlyWithAudioCheckbox\";\r\nimport {\r\n  setConnectOnlyWithAudio,\r\n  setIdentity,\r\n  setRoomId,\r\n} from \"../store/actions\";\r\nimport ErrorMessage from \"./ErrorMessage\";\r\nimport JoinRoomButtons from \"./JoinRoomButtons\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { getRoomExists } from \"../utils/api\";\r\n\r\nconst JoinRoomContent = (props) => {\r\n  const {\r\n    isRoomHost,\r\n    setConnectOnlyWithAudio,\r\n    connectOnlyWithAudio,\r\n    setIdentityAction,\r\n    setRoomIdAction,\r\n  } = props;\r\n\r\n  const [roomIdValue, setRoomIdValue] = useState(\"\");\r\n  const [nameValue, setNameValue] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n\r\n  const history = useHistory();\r\n\r\n  const handleJoinRoom = async () => {\r\n    setIdentityAction(nameValue);\r\n    if (isRoomHost) {\r\n      createRoom();\r\n    } else {\r\n      await joinRoom();\r\n    }\r\n  };\r\n\r\n  const joinRoom = async () => {\r\n    const responseMessage = await getRoomExists(roomIdValue);\r\n\r\n    const { roomExists, full } = responseMessage;\r\n\r\n    if (roomExists) {\r\n      if (full) {\r\n        setErrorMessage(\"Meeting is full. Please try again later.\");\r\n      } else {\r\n        // join a room !\r\n        setRoomIdAction(roomIdValue);\r\n        history.push(\"/room\");\r\n      }\r\n    } else {\r\n      setErrorMessage(\"Meeting not found. Check your meeting id.\");\r\n    }\r\n  };\r\n\r\n  const createRoom = () => {\r\n    history.push(\"/room\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <JoinRoomInputs\r\n        roomIdValue={roomIdValue}\r\n        setRoomIdValue={setRoomIdValue}\r\n        nameValue={nameValue}\r\n        setNameValue={setNameValue}\r\n        isRoomHost={isRoomHost}\r\n      />\r\n      <OnlyWithAudioCheckbox\r\n        setConnectOnlyWithAudio={setConnectOnlyWithAudio}\r\n        connectOnlyWithAudio={connectOnlyWithAudio}\r\n      />\r\n      <ErrorMessage errorMessage={errorMessage} />\r\n      <JoinRoomButtons\r\n        handleJoinRoom={handleJoinRoom}\r\n        isRoomHost={isRoomHost}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStoreStateToProps = (state) => {\r\n  return {\r\n    ...state,\r\n  };\r\n};\r\n\r\nconst mapActionsToProps = (dispatch) => {\r\n  return {\r\n    setConnectOnlyWithAudio: (onlyWithAudio) =>\r\n      dispatch(setConnectOnlyWithAudio(onlyWithAudio)),\r\n    setIdentityAction: (identity) => dispatch(setIdentity(identity)),\r\n    setRoomIdAction: (roomId) => dispatch(setRoomId(roomId)),\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStoreStateToProps,\r\n  mapActionsToProps\r\n)(JoinRoomContent);\r\n","import React, { useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { setIsRoomHost } from \"../store/actions\";\r\nimport JoinRoomTitle from \"./JoinRoomTitle\";\r\nimport JoinRoomContent from \"./JoinRoomContent\";\r\n\r\nimport \"./JoinRoomPage.css\";\r\n\r\nconst JoinRoomPage = (props) => {\r\n  const { setIsRoomHostAction, isRoomHost } = props;\r\n\r\n  const search = useLocation().search;\r\n\r\n  useEffect(() => {\r\n    const isRoomHost = new URLSearchParams(search).get(\"host\");\r\n    if (isRoomHost) {\r\n      setIsRoomHostAction(true);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"join_room_page_container\">\r\n      <div className=\"join_room_page_panel\">\r\n        <JoinRoomTitle isRoomHost={isRoomHost} />\r\n        <JoinRoomContent />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStoreStateToProps = (state) => {\r\n  return {\r\n    ...state,\r\n  };\r\n};\r\n\r\nconst mapActionsToProps = (dispatch) => {\r\n  return {\r\n    setIsRoomHostAction: (isRoomHost) => dispatch(setIsRoomHost(isRoomHost)),\r\n  };\r\n};\r\n\r\nexport default connect(mapStoreStateToProps, mapActionsToProps)(JoinRoomPage);\r\n","import React from \"react\";\n\nconst ChatLabel = () => {\n  return (\n    <div className=\"chat_label_container\">\n      <p className=\"chat_label_paragraph\">CHAT</p>\n    </div>\n  );\n};\n\nexport default ChatLabel;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nconst Message = ({ author, content, sameAuthor, messageCreatedByMe }) => {\n  const alignClass = messageCreatedByMe\n    ? \"message_align_right\"\n    : \"message_align_left\";\n\n  const authorText = messageCreatedByMe ? \"You\" : author;\n\n  const contentAdditionalStyles = messageCreatedByMe\n    ? \"message_right_styles\"\n    : \"message_left_styles\";\n\n  return (\n    <div className={`message_container ${alignClass}`}>\n      {!sameAuthor && <p className=\"message_title\">{authorText}</p>}\n      <p className={`message_content ${contentAdditionalStyles}`}>{content}</p>\n    </div>\n  );\n};\n\nconst Messages = ({ messages }) => {\n  return (\n    <div className=\"messages_container\">\n      {messages.map((message, index) => {\n        const sameAuthor =\n          index > 0 && message.identity === messages[index - 1].identity;\n\n        return (\n          <Message\n            key={`${message.content}${index}`}\n            author={message.identity}\n            content={message.content}\n            sameAuthor={sameAuthor}\n            messageCreatedByMe={message.messageCreatedByMe}\n          />\n        );\n      })}\n    </div>\n  );\n};\n\nconst mapStoreStateToProps = (state) => {\n  return {\n    ...state,\n  };\n};\n\nexport default connect(mapStoreStateToProps)(Messages);\n","export default __webpack_public_path__ + \"static/media/sendMessageButton.9add4f6d.svg\";","import Actions from \"./actions\";\r\n\r\nconst initState = {\r\n  identity: \"\",\r\n  isRoomHost: false,\r\n  connectOnlyWithAudio: false,\r\n  roomId: null,\r\n  showOverlay: true,\r\n  participants: [],\r\n  messages: [],\r\n  activeConversation: null,\r\n  directChatHistory: [],\r\n  socketId: null,\r\n  valid:true\r\n};\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case Actions.SET_IS_ROOM_HOST:\r\n      return {\r\n        ...state,\r\n        isRoomHost: action.isRoomHost,\r\n      };\r\n    case Actions.SET_CONNECT_ONLY_WITH_AUDIO:\r\n      return {\r\n        ...state,\r\n        connectOnlyWithAudio: action.onlyWithAudio,\r\n      };\r\n    case Actions.SET_ROOM_ID:\r\n      return {\r\n        ...state,\r\n        roomId: action.roomId,\r\n      };\r\n    case Actions.SET_IDENTITY:\r\n      return {\r\n        ...state,\r\n        identity: action.identity,\r\n      };\r\n    case Actions.SET_SHOW_OVERLAY:\r\n      return {\r\n        ...state,\r\n        showOverlay: action.showOverlay,\r\n      };\r\n      case 'SET_VALID':\r\n        return {\r\n          ...state,\r\n          valid: action.text,\r\n        };\r\n    case Actions.SET_PARTICIPANTS:\r\n      return {\r\n        ...state,\r\n        participants: action.participants,\r\n      };\r\n    case Actions.SET_MESSAGES:\r\n      return {\r\n        ...state,\r\n        messages: action.messages,\r\n      };\r\n      \r\n    case Actions.SET_ACTIVE_CONVERSATION:\r\n      return {\r\n        ...state,\r\n        activeConversation: action.activeConversation\r\n      }\r\n    case Actions.SET_DIRECT_CHAT_HISTORY:\r\n      return {\r\n        ...state,\r\n        directChatHistory: action.directChatHistory\r\n      };\r\n    case Actions.SET_SOCKET_ID:\r\n      return {\r\n        ...state,\r\n        socketId: action.socketId\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import { configureStore } from \"@reduxjs/toolkit\";\nimport reducer from \"./reducer\";\n\nexport const store = configureStore({\n  reducer: reducer,\n});\n\nexport default store;\n","import { setDirectChatHistory } from \"../store/actions\";\r\nimport store from \"../store/store\";\r\n\r\nexport const appendNewMessageToChatHistory = (data) => {\r\n  const { isAuthor, receiverSocketId, authorSocketId } = data;\r\n\r\n  if (isAuthor) {\r\n    appendMessageToChatHistory(receiverSocketId, data);\r\n  } else {\r\n    appendMessageToChatHistory(authorSocketId, data);\r\n  }\r\n};\r\n\r\nconst appendMessageToChatHistory = (userSocketId, data) => {\r\n  const chatHistory = [...store.getState().directChatHistory];\r\n\r\n  const userChatHistory = chatHistory.find((h) => h.socketId === userSocketId);\r\n\r\n  if (userChatHistory) {\r\n    const newDirectMessage = {\r\n      isAuthor: data.isAuthor,\r\n      messageContent: data.messageContent,\r\n      identity: data.identity,\r\n    };\r\n\r\n    const newUserChatHistory = {\r\n      ...userChatHistory,\r\n      chatHistory: [...userChatHistory.chatHistory, newDirectMessage],\r\n    };\r\n\r\n    const newChatHistory = [\r\n      ...chatHistory.filter((h) => h.socketId !== userSocketId),\r\n      newUserChatHistory,\r\n    ];\r\n\r\n    store.dispatch(setDirectChatHistory(newChatHistory));\r\n  } else {\r\n    const newUserChatHistory = {\r\n      socketId: userSocketId,\r\n      chatHistory: [\r\n        {\r\n          isAuthor: data.isAuthor,\r\n          messageContent: data.messageContent,\r\n          identity: data.identity,\r\n        },\r\n      ],\r\n    };\r\n\r\n    const newChatHistory = [...chatHistory, newUserChatHistory];\r\n\r\n    store.dispatch(setDirectChatHistory(newChatHistory));\r\n  }\r\n};\r\n","import io from \"socket.io-client\";\r\nimport { setRoomId, setParticipants, setSocketId } from \"../store/actions\";\r\nimport store from \"../store/store\";\r\nimport * as webRTCHandler from \"./webRTCHandler\";\r\nimport { appendNewMessageToChatHistory } from \"./directMessages\";\r\nimport {environment} from \"../environment/environment\"\r\n\r\n\r\n// const SERVER = \"https://video-meeting-backend2022.herokuapp.com/\";\r\n\r\nlet socket = null;\r\n\r\nexport const connectWithSocketIOServer = () => {\r\n  socket = io(environment.SERVER);\r\n\r\n  socket.on(\"connect\", () => {\r\n    console.log(\"successfully connected with socket io server\");\r\n    console.log(socket.id);\r\n    store.dispatch(setSocketId(socket.id));\r\n  });\r\n\r\n  socket.on(\"room-id\", (data) => {\r\n    const { roomId } = data;\r\n    store.dispatch(setRoomId(roomId));\r\n  });\r\n\r\n  socket.on(\"room-update\", (data) => {\r\n    const { connectedUsers } = data;\r\n    store.dispatch(setParticipants(connectedUsers));\r\n  });\r\n\r\n  socket.on(\"conn-prepare\", (data) => {\r\n    const { connUserSocketId } = data;\r\n\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, false);\r\n\r\n    // inform the user which just join the room that we have prepared for incoming connection\r\n    socket.emit(\"conn-init\", { connUserSocketId: connUserSocketId });\r\n  });\r\n\r\n  socket.on(\"conn-signal\", (data) => {\r\n    webRTCHandler.handleSignalingData(data);\r\n  });\r\n\r\n  socket.on(\"conn-init\", (data) => {\r\n    const { connUserSocketId } = data;\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, true);\r\n  });\r\n\r\n  socket.on(\"user-disconnected\", (data) => {\r\n    webRTCHandler.removePeerConnection(data);\r\n  });\r\n\r\n  socket.on(\"direct-message\", (data) => {\r\n    appendNewMessageToChatHistory(data);\r\n  });\r\n};\r\n\r\nexport const createNewRoom = (identity, onlyAudio) => {\r\n  // emit an event to server that we would like to create new room\r\n  const data = {\r\n    identity,\r\n    onlyAudio,\r\n  };\r\n\r\n  socket.emit(\"create-new-room\", data);\r\n};\r\n\r\nexport const joinRoom = (identity, roomId, onlyAudio) => {\r\n  //emit an event to server that we would to join a room\r\n  const data = {\r\n    roomId,\r\n    identity,\r\n    onlyAudio,\r\n  };\r\n\r\n  socket.emit(\"join-room\", data);\r\n};\r\n\r\nexport const signalPeerData = (data) => {\r\n  socket.emit(\"conn-signal\", data);\r\n};\r\n\r\nexport const sendDirectMessage = (data) => {\r\n  socket.emit(\"direct-message\", data);\r\n};\r\n","import * as api from \"./api\";\n\nlet TURNIceServers = null;\n\nexport const fetchTURNCredentials = async () => {\n  const responseData = await api.getTURNCredentials();\n\n  if (responseData.token?.iceServers) {\n    TURNIceServers = responseData.token.iceServers;\n  }\n\n  return TURNIceServers;\n};\n\nexport const getTurnIceServers = () => {\n  return TURNIceServers;\n};\n","import React, { useState } from \"react\";\nimport SendMessageButton from \"../../resources/images/sendMessageButton.svg\";\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\n\nconst NewMessage = () => {\n  const [message, setMessage] = useState(\"\");\n\n  const handleTextChange = (event) => {\n    setMessage(event.target.value);\n  };\n\n  const handleKeyPressed = (event) => {\n    if (event.key === \"Enter\") {\n      event.preventDefault();\n\n      // send message to other users\n      sendMessage();\n    }\n  };\n\n  const sendMessage = () => {\n    if (message.length > 0) {\n      webRTCHandler.sendMessageUsingDataChannel(message);\n      setMessage(\"\");\n    }\n  };\n\n  return (\n    <div className=\"new_message_container\">\n      <input\n        className=\"new_message_input\"\n        value={message}\n        onChange={handleTextChange}\n        placeholder=\"Type your message ...\"\n        type=\"text\"\n        onKeyDown={handleKeyPressed}\n      />\n      <img\n        className=\"new_message_button\"\n        src={SendMessageButton}\n        onClick={sendMessage} alt=\"img\"\n      />\n    </div>\n  );\n};\n\nexport default NewMessage;\n","import React from \"react\";\r\nimport ChatLabel from \"./ChatLabel\";\r\nimport Messages from \"./Messages\";\r\nimport NewMessage from \"./NewMessage\";\r\n\r\nconst ChatSection = () => {\r\n  return (\r\n    <div className=\"chat_section_container\">\r\n      <ChatLabel />\r\n      <Messages />\r\n      <NewMessage />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatSection;\r\n","import React from \"react\";\r\n\r\nconst ParticipantsLabel = () => {\r\n  return (\r\n    <div className=\"participants_label_container\">\r\n      <p className=\"participants_label_paragraph\">PARTICIPANTS</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParticipantsLabel;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { setActiveConversation } from \"../../store/actions\";\r\n\r\nconst SingleParticipant = (props) => {\r\n  const {\r\n    identity,\r\n    lastItem,\r\n    participant,\r\n    setActiveConversationAction,\r\n    socketId,\r\n  } = props;\r\n\r\n  const handleOpenActiveChatbox = () => {\r\n    if (participant.socketId !== socketId) {\r\n      setActiveConversationAction(participant);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <p className=\"participants_paragraph\" onClick={handleOpenActiveChatbox}>\r\n        {identity}\r\n      </p>\r\n      {!lastItem && <span className=\"participants_separator_line\"></span>}\r\n    </>\r\n  );\r\n};\r\n\r\nconst Participants = ({\r\n  participants,\r\n  setActiveConversationAction,\r\n  socketId,\r\n}) => {\r\n  return (\r\n    <div className=\"participants_container\">\r\n      {participants.map((participant, index) => {\r\n        return (\r\n          <SingleParticipant\r\n            key={participant.identity}\r\n            lastItem={participants.length === index + 1}\r\n            participant={participant}\r\n            identity={participant.identity}\r\n            setActiveConversationAction={setActiveConversationAction}\r\n            socketId={socketId}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStoreStateToProps = (state) => {\r\n  return {\r\n    ...state,\r\n  };\r\n};\r\n\r\nconst mapActionsToProps = (dispatch) => {\r\n  return {\r\n    setActiveConversationAction: (activeConversation) =>\r\n      dispatch(setActiveConversation(activeConversation)),\r\n  };\r\n};\r\n\r\nexport default connect(mapStoreStateToProps, mapActionsToProps)(Participants);\r\n","import React from \"react\";\r\nimport ParticipantsLabel from \"./ParticipantsLabel\";\r\nimport Participants from \"./Participants\";\r\n// import DirectChat from './DirectChat/DirectChat';\r\n\r\nconst ParticipantsSection = () => {\r\n  return (\r\n    <div className=\"participants_section_container\">\r\n      <ParticipantsLabel />\r\n      <Participants />\r\n      {/* <DirectChat /> */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParticipantsSection;\r\n","export default __webpack_public_path__ + \"static/media/camera.b50348a3.svg\";","export default __webpack_public_path__ + \"static/media/cameraOff.a61d4a02.svg\";","import React, { useState } from \"react\";\r\n\r\nimport CameraButtonImg from \"../../resources/images/camera.svg\";\r\nimport CameraButtonImgOff from \"../../resources/images/cameraOff.svg\";\r\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\r\n\r\nconst CameraButton = () => {\r\n  const [isLocalVideoDisabled, setIsLocalVideoDisabled] = useState(false);\r\n\r\n  const handleCameraButtonPressed = () => {\r\n    webRTCHandler.toggleCamera(isLocalVideoDisabled);\r\n\r\n    setIsLocalVideoDisabled(!isLocalVideoDisabled);\r\n  };\r\n\r\n  return (\r\n    <div className=\"video_button_container\">\r\n      <img\r\n        src={isLocalVideoDisabled ? CameraButtonImgOff : CameraButtonImg}\r\n        className=\"video_button_image\"\r\n        onClick={handleCameraButtonPressed}\r\n        alt=\"cam\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CameraButton;\r\n","import React from \"react\";\r\n\r\nconst LeaveRoomButton = () => {\r\n  const handleRoomDisconnection = () => {\r\n    const siteUrl = window.location.origin;\r\n    window.location.href = siteUrl;\r\n  };\r\n\r\n  return (\r\n    <div className=\"video_button_container\">\r\n      <button className=\"video_button_end\" onClick={handleRoomDisconnection}>\r\n        Leave Room\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LeaveRoomButton;\r\n","export default __webpack_public_path__ + \"static/media/mic.c9c9788e.svg\";","export default __webpack_public_path__ + \"static/media/micOff.3a72f682.svg\";","import React, { useState } from \"react\";\r\nimport MicButtonImg from \"../../resources/images/mic.svg\";\r\nimport MicButtonImgOff from \"../../resources/images/micOff.svg\";\r\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\r\n\r\nconst MicButton = () => {\r\n  const [isMicMuted, setIsMicMuted] = useState(false);\r\n\r\n  const handleMicButtonPressed = () => {\r\n    webRTCHandler.toggleMic(isMicMuted);\r\n\r\n    setIsMicMuted(!isMicMuted);\r\n  };\r\n\r\n  return (\r\n    <div className=\"video_button_container\">\r\n      <img\r\n        src={isMicMuted ? MicButtonImgOff : MicButtonImg}\r\n        onClick={handleMicButtonPressed}\r\n        className=\"video_button_image\"\r\n        alt=\"img\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MicButton;\r\n","export default __webpack_public_path__ + \"static/media/switchToScreenSharing.900d9338.svg\";","import React, { useRef, useEffect } from \"react\";\n\nconst LocalScreenSharingPreview = ({ stream }) => {\n  const localPreviewRef = useRef();\n\n  useEffect(() => {\n    const video = localPreviewRef.current;\n\n    video.srcObject = stream;\n\n    video.onloadedmetadata = () => {\n      video.play();\n    };\n  }, [stream]);\n\n  return (\n    <div className=\"local_screen_share_preview\">\n      <video muted autoPlay ref={localPreviewRef}></video>\n    </div>\n  );\n};\n\nexport default LocalScreenSharingPreview;\n","import React, { useState } from \"react\";\r\nimport SwitchImg from \"../../resources/images/switchToScreenSharing.svg\";\r\nimport LocalScreenSharingPreview from \"./LocalScreenSharingPreview\";\r\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\r\n\r\nconst constraints = {\r\n  audio: false,\r\n  video: true,\r\n};\r\n\r\nconst SwitchToScreenSharingButton = () => {\r\n  const [isScreenSharingActive, setIsScreenSharingActive] = useState(false);\r\n  const [screenSharingStream, setScreenSharingStream] = useState(null);\r\n\r\n  const handleScreenShareToggle = async () => {\r\n    if (!isScreenSharingActive) {\r\n      let stream = null;\r\n      try {\r\n        stream = await navigator.mediaDevices.getDisplayMedia(constraints);\r\n      } catch (err) {\r\n        console.log(\r\n          \"error occurred when trying to get an access to screen share stream\"\r\n        );\r\n      }\r\n      if (stream) {\r\n        setScreenSharingStream(stream);\r\n\r\n        webRTCHandler.toggleScreenShare(isScreenSharingActive, stream);\r\n        setIsScreenSharingActive(true);\r\n        // execute here function to switch the video track which we are sending to other users\r\n      }\r\n    } else {\r\n      webRTCHandler.toggleScreenShare(isScreenSharingActive);\r\n      setIsScreenSharingActive(false);\r\n\r\n      // stop screen share stream\r\n      screenSharingStream.getTracks().forEach((t) => t.stop());\r\n      setScreenSharingStream(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"video_button_container\">\r\n        <img\r\n          src={SwitchImg}\r\n          onClick={handleScreenShareToggle}\r\n          className=\"video_button_image\"\r\n        alt=\"img\"\r\n        />\r\n      </div>\r\n      {isScreenSharingActive && (\r\n        <LocalScreenSharingPreview stream={screenSharingStream} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SwitchToScreenSharingButton;\r\n","import React from \"react\";\r\nimport CameraButton from \"./CameraButton\";\r\nimport LeaveRoomButton from \"./LeaveRoomButton\";\r\nimport MicButton from \"./MicButton\";\r\n// import SwitchToScreenSharingButton from \"./SwitchToScreenSharingButton\";\r\nimport { connect } from \"react-redux\";\r\nimport SwitchToScreenSharingButton from \"./SwitchToScreenSharingButton\";\r\n\r\nconst VideoButtons = (props) => {\r\n  const { connectOnlyWithAudio } = props;\r\n\r\n  return (\r\n    <div className=\"video_buttons_container\">\r\n      <MicButton />\r\n      {!connectOnlyWithAudio && <CameraButton />}\r\n      <LeaveRoomButton />\r\n      {!connectOnlyWithAudio && <SwitchToScreenSharingButton />}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStoreStateToProps = (state) => {\r\n  return {\r\n    ...state,\r\n  };\r\n};\r\n\r\nexport default connect(mapStoreStateToProps)(VideoButtons);\r\n","import React from \"react\";\r\nimport VideoButtons from \"./VideoButtons\";\r\n\r\nconst VideoSection = () => {\r\n  return (\r\n    <div className=\"video_section_container\">\r\n      <VideoButtons />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoSection;\r\n","import React from \"react\";\r\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\r\n\r\nconst RoomLabel = ({ roomId }) => {\r\n  return (\r\n    <div className=\"room_label\">\r\n      <p className=\"room_label_paragraph\">ID: {roomId} \r\n      <CopyToClipboard text={roomId}>\r\n        <button>Copy ID</button>\r\n      </CopyToClipboard></p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RoomLabel;\r\n","import React from \"react\";\r\n\r\nconst Overlay = () => {\r\n  return (\r\n    <div className=\"overlay_container\">\r\n      <div className=\"loader\"></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Overlay;\r\n","import React from 'react'\r\n// import PrimaryButton from '../../globalComponents/buttons/primaryButton/PrimaryButton'\r\nimport './error.css'\r\n\r\nconst ErrorPopup = ({isOpen}) => {\r\n\r\n    const navigate =()=>{\r\n            window.location.href=\"https://eclectic-buttercream-298f4c.netlify.app\"\r\n            console.log(\"click\")\r\n    }\r\n\r\n    return (\r\n        <div className={`popupOuter ${isOpen ? 'active' : ''}`}>\r\n            <div className=\"confirmationPopupContainer\">\r\n                {/* <div className=\"popupHeader\">\r\n                    <p className=\"popupTitle\">{\"Error!!\"}</p>\r\n                    <img onClick={onClick} src=\"../resources/images/x-close.svg\" alt=\"\" />\r\n                </div> */}\r\n                <div className=\"popupBody\">\r\n                    <p className=\"popupText\"> <b>{\"Error occurred when trying to get an access to your Audio or Video devices\"}</b>. Please get back to home page</p>\r\n                    <div className=\"popupBtnGrp\">\r\n                        {/* <PrimaryButton classname={btnType} children={btnText}/>\r\n                         */}\r\n\r\n                         <button style={{zIndex:'10000000000000'}} type=\"btn\" onClick={navigate} alt=\"btn\" className='btn-blue'>Continue</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ErrorPopup","import React, { useEffect,useState } from \"react\";\r\nimport ChatSection from \"./ChatSection/ChatSection\";\r\nimport ParticipantsSection from \"./ParticipantsSection/ParticipantsSection\";\r\nimport VideoSection from \"./VideoSection/VideoSection\";\r\nimport RoomLabel from \"./RoomLabel\";\r\nimport { connect } from \"react-redux\";\r\nimport * as webRTCHandler from \"../utils/webRTCHandler\";\r\nimport Overlay from \"./Overlay\";\r\nimport ErrorPopup from \"../Popup/ErrorPopup\";\r\n\r\nimport \"./RoomPage.css\";\r\n\r\nconst RoomPage = ({\r\n  roomId,\r\n  identity,\r\n  isRoomHost,\r\n  showOverlay,\r\n  connectOnlyWithAudio,\r\n  valid\r\n}) => {\r\n  const [show, setShow] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (!isRoomHost && !roomId) {\r\n      const siteUrl = window.location.origin;\r\n      window.location.href = siteUrl;\r\n    } else {\r\n     webRTCHandler.GetLocalPreviewAndInitRoomConnection(\r\n        isRoomHost,\r\n        identity,\r\n        roomId,\r\n        connectOnlyWithAudio\r\n      )\r\n      console.log(valid);  \r\n    }\r\n    // eslint-disable-next-line\r\n  }, []);\r\nuseEffect(()=>{\r\n  if(!valid && !connectOnlyWithAudio){\r\n    setShow(true)\r\n  }\r\n},[valid,connectOnlyWithAudio])\r\n\r\n  return (\r\n    <div className=\"room_container\">\r\n      <ParticipantsSection />\r\n      <ErrorPopup isOpen={show}/>\r\n      <VideoSection />\r\n      <ChatSection />\r\n      <RoomLabel roomId={roomId} />\r\n      {showOverlay && <Overlay />}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStoreStateToProps = (state) => {\r\n  return {\r\n    ...state,\r\n  };\r\n};\r\n\r\nexport default connect(mapStoreStateToProps)(RoomPage);\r\n","import React, { useEffect } from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport IntroductionPage from \"./IntroductionPage/IntroductionPage\";\nimport JoinRoomPage from \"./JoinRoomPage/JoinRoomPage\";\nimport RoomPage from \"./RoomPage/RoomPage\";\nimport { connectWithSocketIOServer } from \"./utils/wss\";\n\nimport \"./App.css\";\n\nfunction App() {\n  useEffect(() => {\n    connectWithSocketIOServer();\n  }, []);\n\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/join-room\">\n          <JoinRoomPage />\n        </Route>\n        <Route path=\"/room\">\n          <RoomPage />\n        </Route>\n        <Route path=\"/\">\n          <IntroductionPage />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { store } from './store/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}